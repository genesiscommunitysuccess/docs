"use strict";(self.webpackChunk_genesislcap_docs=self.webpackChunk_genesislcap_docs||[]).push([[94723],{5348:function(e,t,s){s.r(t),s.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return p},frontMatter:function(){return r},metadata:function(){return c},toc:function(){return d}});var n=s(87462),i=s(63366),a=(s(67294),s(3905)),o=(s(61839),["components"]),r={title:"Gateways and Streamers - Customisation",sidebar_label:"Customisation",id:"customisation",keywords:["server","integration","gateways","streamers","customisation"],tags:["server","integration","gateways","streamers","customisation"]},l=void 0,c={unversionedId:"server/integration/gateways-and-streamers/customisation",id:"server/integration/gateways-and-streamers/customisation",title:"Gateways and Streamers - Customisation",description:"While the standard architecture of the FIX gateway is more than sufficient for most use cases, it is not ideal for more demanding architectures.",source:"@site/docs/03_server/10_integration/04_gateways-and-streamers/05_customisation.md",sourceDirName:"03_server/10_integration/04_gateways-and-streamers",slug:"/server/integration/gateways-and-streamers/customisation",permalink:"/next/server/integration/gateways-and-streamers/customisation",draft:!1,tags:[{label:"server",permalink:"/next/tags/server"},{label:"integration",permalink:"/next/tags/integration"},{label:"gateways",permalink:"/next/tags/gateways"},{label:"streamers",permalink:"/next/tags/streamers"},{label:"customisation",permalink:"/next/tags/customisation"}],version:"current",sidebarPosition:5,frontMatter:{title:"Gateways and Streamers - Customisation",sidebar_label:"Customisation",id:"customisation",keywords:["server","integration","gateways","streamers","customisation"],tags:["server","integration","gateways","streamers","customisation"]},sidebar:"serverModulesSidebar",previous:{title:"FIX-Xlator",permalink:"/next/server/integration/gateways-and-streamers/fix-xlator"},next:{title:"Examples",permalink:"/next/server/integration/gateways-and-streamers/examples"}},u={},d=[{value:"Customisation through injection",id:"customisation-through-injection",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Message listeners",id:"message-listeners",level:2},{value:"Message publishers",id:"message-publishers",level:2},{value:"Message stores",id:"message-stores",level:2}],m={toc:d};function p(e){var t=e.components,s=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,n.Z)({},m,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"While the standard architecture of the FIX gateway is more than sufficient for most use cases, it is not ideal for more demanding architectures."),(0,a.kt)("p",null,"Systems requiring high throughput or low latency may not want to persist messages and session states to an out-of-process database."),(0,a.kt)("p",null,"The FIX gateway is highly customisable,  allowing the addition of custom logon authenticators, inbound and outbound message handlers, and session state persistence stores."),(0,a.kt)("p",null,"The gateway also provides a number of out-of-the-box implementations that can be configured without providing custom code."),(0,a.kt)("h2",{id:"customisation-through-injection"},"Customisation through injection"),(0,a.kt)("p",null,"Custom components are injected through the standard dependency-injection mechanism for the platform."),(0,a.kt)("p",null,"The process bootstrap will scan packages specified in the package block of the process definition in the ",(0,a.kt)("em",{parentName:"p"},"applicationName"),"-",(0,a.kt)("strong",{parentName:"p"},"processes.xml")," file."),(0,a.kt)("p",null,"If no implementations of certain interfaces are found, it will provide default implementations."),(0,a.kt)("p",null,"To inject a custom interface, all you need to do is:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Create a class that implements the appropriate interface."),(0,a.kt)("li",{parentName:"ol"},"Make sure the package is scanned by specifying it in the package block of the process definition."),(0,a.kt)("li",{parentName:"ol"},"Annotate your class with the @Module annotation that the framework provides.")),(0,a.kt)("h2",{id:"authentication"},"Authentication"),(0,a.kt)("p",null,"The interface for authentication of logon messages is ",(0,a.kt)("inlineCode",{parentName:"p"},"AuthenticationStrategy"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},"interface AuthenticationStrategy {\n    fun fromAdmin(message: Message, sessionID: SessionID)\n}\n")),(0,a.kt)("p",null,"The interface is called on receipt of an admin FIX message from a session (which includes logon messages)."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"If the method call returns, the logon is accepted"),(0,a.kt)("li",{parentName:"ul"},"If the method throws a RejectLogon exception, the logon is rejected.")),(0,a.kt)("p",null,"The default implementation authenticates the username and password provided in standard FIX tags 553 and 554 of the Logon message."),(0,a.kt)("p",null,"It will validate these and the CompId fields against an entry in the ",(0,a.kt)("inlineCode",{parentName:"p"},"FIX_SESSION_AUTH")," table, which is provided as part of the FIX product distribution."),(0,a.kt)("p",null,"The default implementation is disabled by default. In order to enable it, add the following to the FIX Gateway process configuration file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<authenticateLogonCredentials>true</authenticateLogonCredentials> \n")),(0,a.kt)("h2",{id:"message-listeners"},"Message listeners"),(0,a.kt)("p",null,"The interface for custom message receivers is ",(0,a.kt)("inlineCode",{parentName:"p"},"QuickFixMessageListener"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},"interface QuickFixMessageListener {\n    fun onInit()\n    fun onCreate(sessionID: SessionID) {}\n    fun fromApp(sessionID: SessionID, message: Message)\n    fun toApp(sessionID: SessionID, message: Message) {}\n    fun fromAdmin(sessionID: SessionID, message: Message) {}\n    fun toAdmin(sessionID: SessionID, message: Message) {}\n    fun onLogon(sessionID: SessionID)\n    fun onLogoff(sessionID: SessionID)\n}\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"onInit()")," method is called after process bootstrapping is complete."),(0,a.kt)("p",null,"At this stage, you can be confident that all the configured FIX sessions have been registered and any socket connectors have been started."),(0,a.kt)("p",null,"Additional callbacks are invoked when events are received from the FIX engine."),(0,a.kt)("p",null,"It is important that any code in your implementation of this interface does not block the calling thread."),(0,a.kt)("h2",{id:"message-publishers"},"Message publishers"),(0,a.kt)("p",null,"The interface for custom message receivers is ",(0,a.kt)("inlineCode",{parentName:"p"},"QuickFixMessagePublisher"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},"interface QuickFixMessagePublisher {\n    fun onInit()\n    fun onCreate(sessionID: SessionID)\n    fun fromApp(sessionID: SessionID, message: Message)\n    fun fromAdmin(sessionID: SessionID, message: Message)\n    fun onLogon(sessionID: SessionID)\n    fun onLogoff(sessionID: SessionID)\n}\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"onInit()")," method is called after process bootstrapping is complete."),(0,a.kt)("p",null,"At this stage, you can be confident that all the configured FIX sessions have been registered and any socket connectors have been started."),(0,a.kt)("p",null,"Additional callbacks are invoked when events are received from the FIX engine."),(0,a.kt)("p",null,"In order to send FIX messages from within this implementation, separate classes called ",(0,a.kt)("inlineCode",{parentName:"p"},"FixSessionRegistry")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"FixMessageSender")," can be used to look up active sessions and send FIX messages respectively:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Module\npublic class SampleMessagePublisher implements QuickFixMessagePublisher {\n    private final FixSessionRegistry registry;\n    private final FixMessageSender sender;\n    @Inject\n    public SampleMessagePublisher(FixSessionRegistry registry, FixMessageSender sender) {\n        this.registry = registry;\n        this.sender = sender;\n    }\n    \n    @Override\n    public void onLogon(@NotNull SessionID sessionID) {\n        new Thread(this::startReadLoop()).start();\n    }\n    \n    private void startReadLoop() {\n        while (true) {\n            // Read message from external system\n            Message message = ExternalSystem.readMessage();\n            // Resolve session ID and lookup session in registry\n            // Session is not logged on if not present in registry, if so, return message to queue\n            QuickfixSession quickfixSession = registry.lookupActiveSession(someSessionId);\n            sender.sendMessage(message, someSessionId);\n        }\n    }\n    @Override\n    public void onLogoff(@NotNull SessionID sessionID) {\n        // Stop loop\n    }\n    \n    @Override\n    public void onInit() {}\n    @Override\n    public void onCreate(@NotNull SessionID sessionID) {}\n    @Override\n    public void fromAdmin(@NotNull SessionID sessionID, @NotNull Message message) {}\n    @Override\n    public void fromApp(@NotNull SessionID sessionID, @NotNull Message message) {}\n}\n")),(0,a.kt)("p",null,"It is important that any code in your implementation of this interface does not block the calling thread."),(0,a.kt)("h2",{id:"message-stores"},"Message stores"),(0,a.kt)("p",null,"In order to provide custom code for FIX session state persistence and message recovery, the interface required is ",(0,a.kt)("inlineCode",{parentName:"p"},"MessageStoreFactory"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"public interface MessageStoreFactory {\n    MessageStore create(SessionID sessionID);\n}\n")),(0,a.kt)("p",null,"Which is closely linked to the ",(0,a.kt)("inlineCode",{parentName:"p"},"MessageStore"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"public interface MessageStore {\n    boolean set(int sequence, String message) throws IOException;\n    void get(int startSequence, int endSequence, Collection<String> messages) throws IOException;\n    int getNextSenderMsgSeqNum() throws IOException;\n    int getNextTargetMsgSeqNum() throws IOException;\n    void setNextSenderMsgSeqNum(int next) throws IOException;\n    void setNextTargetMsgSeqNum(int next) throws IOException;\n    void incrNextSenderMsgSeqNum() throws IOException;\n    void incrNextTargetMsgSeqNum() throws IOException;\n    Date getCreationTime() throws IOException;\n    void reset() throws IOException;\n    void refresh() throws IOException;\n}\n")),(0,a.kt)("p",null,"See the QuickFIXJ ",(0,a.kt)("a",{parentName:"p",href:"https://javadoc.io/static/org.quickfixj/quickfixj-core/2.3.0/quickfix/MessageStore.html"},"official documentation")," for more information."))}p.isMDXComponent=!0}}]);