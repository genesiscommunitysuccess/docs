"use strict";(self.webpackChunk_genesislcap_docs=self.webpackChunk_genesislcap_docs||[]).push([[9525],{44715:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return o},default:function(){return h},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return d}});var i=n(87462),a=n(63366),s=(n(67294),n(3905)),r=(n(61839),["components"]),l={title:"Access Control - Username and Password Authentication",sidebar_label:"Username and Password Authentication",id:"password-authentication",keywords:["server","access control","password","authentication"],tags:["server","access control","password","authentication"]},o=void 0,u={unversionedId:"server/access-control/password-authentication",id:"server/access-control/password-authentication",title:"Access Control - Username and Password Authentication",description:"Introduction  | Authentication overview | Username and Password | SSO | Authorisation overview | Authorisation",source:"@site/docs/03_server/05_access-control/03_password_authentication.md",sourceDirName:"03_server/05_access-control",slug:"/server/access-control/password-authentication",permalink:"/next/server/access-control/password-authentication",draft:!1,tags:[{label:"server",permalink:"/next/tags/server"},{label:"access control",permalink:"/next/tags/access-control"},{label:"password",permalink:"/next/tags/password"},{label:"authentication",permalink:"/next/tags/authentication"}],version:"current",sidebarPosition:3,frontMatter:{title:"Access Control - Username and Password Authentication",sidebar_label:"Username and Password Authentication",id:"password-authentication",keywords:["server","access control","password","authentication"],tags:["server","access control","password","authentication"]},sidebar:"serverModulesSidebar",previous:{title:"Authentication Overview",permalink:"/next/server/access-control/authentication-overview"},next:{title:"SSO Authentication",permalink:"/next/server/access-control/SSO-authentication"}},p={},d=[{value:"security",id:"security",level:2},{value:"authentication",id:"authentication",level:3},{value:"passwordValidation",id:"passwordvalidation",level:3},{value:"passwordStrength",id:"passwordstrength",level:4},{value:"passwordRetry",id:"passwordretry",level:3},{value:"mfa",id:"mfa",level:3},{value:"loginAck",id:"loginack",level:3},{value:"loadRecord",id:"loadrecord",level:4},{value:"fields",id:"fields",level:4},{value:"Example",id:"example",level:3},{value:"Message flows",id:"message-flows",level:2},{value:"Pre-authentication",id:"pre-authentication",level:3},{value:"Login preferences",id:"login-preferences",level:4},{value:"Request",id:"request",level:5},{value:"Response",id:"response",level:5},{value:"Authentication",id:"authentication-1",level:3},{value:"Login",id:"login",level:4},{value:"Request",id:"request-1",level:5},{value:"Response",id:"response-1",level:5},{value:"Password change",id:"password-change",level:4},{value:"Request",id:"request-2",level:5},{value:"Response",id:"response-2",level:5},{value:"Reset password",id:"reset-password",level:4},{value:"Request",id:"request-3",level:5},{value:"Response",id:"response-3",level:5},{value:"Post-authentication",id:"post-authentication",level:3},{value:"Request",id:"request-4",level:5},{value:"Response",id:"response-4",level:5},{value:"Rights polling",id:"rights-polling",level:4},{value:"Entity management",id:"entity-management",level:4},{value:"Insert profile",id:"insert-profile",level:4},{value:"Request",id:"request-5",level:5},{value:"Response",id:"response-5",level:5},{value:"Amend Profile",id:"amend-profile",level:4},{value:"Request",id:"request-6",level:5},{value:"Response",id:"response-6",level:5},{value:"Delete Profile",id:"delete-profile",level:4},{value:"Request",id:"request-7",level:5},{value:"Response",id:"response-7",level:5},{value:"Insert User",id:"insert-user",level:4},{value:"Request",id:"request-8",level:5},{value:"Response",id:"response-8",level:5},{value:"Amend User",id:"amend-user",level:4},{value:"Request",id:"request-9",level:5},{value:"Response",id:"response-9",level:5},{value:"Delete User",id:"delete-user",level:4},{value:"Request",id:"request-10",level:5},{value:"Response",id:"response-10",level:5}],c={toc:d};function h(e){var t=e.components,n=(0,a.Z)(e,r);return(0,s.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"/server/access-control/introduction"},"Introduction"),"  | ",(0,s.kt)("a",{parentName:"p",href:"/server/access-control/authentication-overview"},"Authentication overview")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/access-control/password-authentication"},"Username and Password")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/access-control/sso-authentication"},"SSO")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/access-control/authorisation-overview"},"Authorisation overview")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/access-control/authorisation"},"Authorisation")),(0,s.kt)("p",null,"We will now go through the various configuration options available for authentication. These are located in your ",(0,s.kt)("em",{parentName:"p"},"application-name-"),(0,s.kt)("strong",{parentName:"p"},"auth-preferences.kts")," file."),(0,s.kt)("p",null,"All of these configuration settings are wrapped within the ",(0,s.kt)("inlineCode",{parentName:"p"},"security")," function."),(0,s.kt)("h2",{id:"security"},"security"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"security")," function wraps all other variable and functions within the ",(0,s.kt)("strong",{parentName:"p"},"auth-preferences.kts")," file. From this top level the following variables can be set."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"sessionTimeoutMins")," specifies a time out for the session. Sessions are timed out (logged out) after the value defined here. The front end of your application can monitor web movement, page changes, etc. and perform an ",(0,s.kt)("a",{parentName:"li",href:"/server/integration/rest-endpoints/advanced/#event_login_refresh"},"automatic refresh")," - in which case, the user is not aware of the logout and the start of the new session. Default: 30 minutes."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"expiryCheckMins")," specifies the time interval (in minutes) used to check for idle sessions in the system. Default: 5 minutes."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"maxSimultaneousUserLogins")," specifies the maximum number of concurrent, active sessions a user can maintain. Once this limit has been reached, the user cannot log in again until another session has been logged out. If the value zero is not defined, or is not a positive integer, then any number of sessions is permitted. Default: 0.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-kotlin"},"security {\n  sessionTimeoutMins = 60 //60 minutes (not the default 30 minutes)\n  expiryCheckMins = 10 //5 minutes (not the default 5 minutes)\n  maxSimultaneousUserLogins = 5 //5 active sessions (not the default unlimited)\n}\n")),(0,s.kt)("p",null,"From within ",(0,s.kt)("inlineCode",{parentName:"p"},"security")," we can also invoke the further functions in order to configure our username and password authentication. These are detailed below."),(0,s.kt)("h3",{id:"authentication"},"authentication"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"authentication")," function is used to define common features of all three types of authentication. Within it, many variables can be set, but their use depends on the value given to the ",(0,s.kt)("inlineCode",{parentName:"p"},"type")," variable."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"type")," indicates which of the three types of username and password authentication to be used. It accepts the values of: ",(0,s.kt)("inlineCode",{parentName:"li"},"AuthType.INTERNAL"),", ",(0,s.kt)("inlineCode",{parentName:"li"},"AuthType.LDAP")," or ",(0,s.kt)("inlineCode",{parentName:"li"},"AuthType.HYBRID"),". Default: ",(0,s.kt)("inlineCode",{parentName:"li"},"AuthType.INTERNAL"),".")),(0,s.kt)("p",null,"For more information on each of these three authentication types, please see the ",(0,s.kt)("a",{parentName:"p",href:"/server/access-control/authentication-overview/#username-and-password-authentication"},"authentication overview"),"."),(0,s.kt)("p",null,"The following variables are used to configure an LDAP connection; thus are only used when ",(0,s.kt)("inlineCode",{parentName:"p"},"type")," is either ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthType.LDAP")," or ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthType.HYBRID"),"."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"url")," specifies the LDAP server hostname. Default: ",(0,s.kt)("inlineCode",{parentName:"li"},"localhost"),"."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"port")," specifies the LDAP server port. Default: 389."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"searchBases")," defines the location(s) in the directory in which the LDAP search begins. Default: an organisational unit of ",(0,s.kt)("inlineCode",{parentName:"li"},"temp")," with a domain component of ",(0,s.kt)("inlineCode",{parentName:"li"},"temp")," (",(0,s.kt)("inlineCode",{parentName:"li"},"ou=temp,dc=temp"),").",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"This is set by first invoking the ",(0,s.kt)("inlineCode",{parentName:"li"},"searchBases")," function, and repeatedly invoking ",(0,s.kt)("inlineCode",{parentName:"li"},"searchBase(location)")," function(s) within it, where ",(0,s.kt)("inlineCode",{parentName:"li"},"location")," is given as a distinguished name."))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"userGroups")," defines the group(s) that the user needs to belong with the LDAP server in order to log in. Default: no groups.",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"This is set by first invoking the ",(0,s.kt)("inlineCode",{parentName:"li"},"userGroups")," function, and repeatedly invoking ",(0,s.kt)("inlineCode",{parentName:"li"},"userGroup(group)")," function(s) within it, where ",(0,s.kt)("inlineCode",{parentName:"li"},"group")," is given as a distinguished name."))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"userPrefix")," specifies a prefix added to every username when communicated with the LDAP server. Default: an empty string."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"bindDn")," specifies the distinguished name which represents the application within the LDAP server. Normally LDAP servers do not allow anonymous searches, and thus require this. If ",(0,s.kt)("inlineCode",{parentName:"li"},"bindDn")," is not specified, no bindings will be used. Default: null"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"bindPassword")," specifies the password associated with the ",(0,s.kt)("inlineCode",{parentName:"li"},"bindDn")," account. If ",(0,s.kt)("inlineCode",{parentName:"li"},"bindDn")," is not specified, this value is not used. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"userIdType")," defines the attribute to match in the directory search against the provided username. Default: ",(0,s.kt)("inlineCode",{parentName:"li"},"cn"),". ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Amongst the most common LDAP implementations, you can find three main ways of configuring usernames:",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"using the ",(0,s.kt)("inlineCode",{parentName:"li"},"uid")," attribute (Userid)"),(0,s.kt)("li",{parentName:"ul"},"using the ",(0,s.kt)("inlineCode",{parentName:"li"},"cn")," attribute (Common Name)"),(0,s.kt)("li",{parentName:"ul"},"using the ",(0,s.kt)("inlineCode",{parentName:"li"},"sAMAccountName")," in Windows"))))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"bypassLoginInternalAuth")," this is a boolean flag that prevents internal authorisation checks on login"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"onLoginSuccess")," this is a function which is invoked on a successful LDAP login, for example: it allows you to insert a user into the db when it exists in LDAP but not the database."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"useTLS")," this is a boolean value indicating whether or not to use TLS encryption on the connection to the remote LDAP server.")),(0,s.kt)("p",null,"For more information on the various authentication types, please see the ",(0,s.kt)("a",{parentName:"p",href:"/server/access-control/authentication-overview/"},"Authentication overview"),"."),(0,s.kt)("h3",{id:"passwordvalidation"},"passwordValidation"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"passwordValidation")," function enables password validation, and is used to set the variables relating to this validation. "),(0,s.kt)("p",null,"These following variables are used to configure the application's password validation; thus are only used when ",(0,s.kt)("inlineCode",{parentName:"p"},"type")," is either ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthType.INTERNAL")," or ",(0,s.kt)("inlineCode",{parentName:"p"},"AuthType.HYBRID"),"."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"passwordSalt")," defines a system specific salt to be added to your password hashes. This is a security measure that ensures that the same combination of username and password on different applications built on the Genesis low-code platform are stored as different hashes. Default: empty string indicating no additional salting.")),(0,s.kt)("p",null,"In addition, from within ",(0,s.kt)("inlineCode",{parentName:"p"},"passwordValidation")," the ",(0,s.kt)("inlineCode",{parentName:"p"},"passwordStrength")," method can be invoked as below."),(0,s.kt)("h4",{id:"passwordstrength"},"passwordStrength"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"passwordStrength")," function can be called within ",(0,s.kt)("inlineCode",{parentName:"p"},"passwordValidation")," to set many configuration variables. These enable you to specify in detail the mandatory characteristics for the password. "),(0,s.kt)("p",null,"Within this function, the following variables can be set:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"minimumLength")," specifies the minimum length of password. If null or undefined this assumes there is no minimum limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"maximumLength")," specifies the maximum length of password. If null or undefined this assumes there is no maximum limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"minDigits")," specifies the minimum number of numerical digits required in a password. If null or undefined this assumes there is no minimum limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"maxRepeatCharacters")," specifies the maximum number of the same characters across an entire password. This does not just include consecutive repeat characters, which is controlled by the ",(0,s.kt)("inlineCode",{parentName:"li"},"repeatCharacterRestrictSize")," variable below. If null or undefined this assumes there is no maximum limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"minUppercaseCharacters")," specifies the minimum number of upper-case characters in a password. If null or undefined this assumes there is no minimum limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"minLowercaseCharacters")," specifies the minimum number of lower-case characters in a password. If null or undefined this assumes there is no minimum limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"minNonAlphaNumericCharacters")," specifies the minimum number of non-alphanumeric characters, such as punctuation and other special characters. If null or undefined this assumes there is no minimum limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restrictWhitespace")," specifies if whitespace characters are prevented from being used in passwords. Default: true."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restrictAlphaSequences")," specifies if alphabetical sequences in passwords (e.g. abcdefg) are restricted. Sequences greater than or equal to five characters won't be permitted if this is true. Default: false."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restrictQWERTY")," specifies if QWERTY sequences in passwords (e.g. qwertyuiop) are restricted. Sequences greater or equal to five characters won't be permitted if this is true. Default: true."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restrictNumericalSequences")," specifies if numerical sequences in passwords (e.g. 123456) are restricted. Sequences greater or equal to five numbers won't be allowed if active. Default: true."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"illegalCharacters")," specifies which characters are not permitted in user passwords. Default: empty."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"historicalCheck")," specifies how many previous passwords to check against, in order to prevent password re-use. If null or undefined no historical check is performed. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restrictPassword")," specifies if the password should differ from a list of the worst passwords stored within the application. Default: false."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restrictDictionarySubstring")," specifies if any dictionary word of 4 or more characters can be included in a password (either forwards or backwards). Default: false."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restrictUserName")," specifies if the user's username is restricted as part of their password. Default: false."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"repeatCharacterRestrictSize")," specifies the number of consecutive repeated characters that make a password restricted. If null or undefined this assumes there is no limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"passwordExpiryDays")," specifies how many days before a password expires. If null or undefined this assumes there is no limit. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"passwordExpiryNotificationDays")," specifies how many days before their password expiry, a user is notified. If null or undefined a user not notified in advance of their password expiry. Default: null.")),(0,s.kt)("h3",{id:"passwordretry"},"passwordRetry"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"passwordRetry")," function allows you to configure settings for limiting the rate at which a user can retry passwords. It allows the following variables to be set:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"maxAttempts")," specifies the maximum number of attempts allowed if a user enters a wrong password. Default: 3 attempts."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"waitTimeMins")," specifies the time to wait in minutes when the maximum number of incorrect attempts is reached, before allowing a user to try again. Default: 5 minutes.")),(0,s.kt)("h3",{id:"mfa"},"mfa"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"mfa")," function allows you to configure Multi-factor Authentication (MFA). For more information on MFA please see ",(0,s.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Multi-factor_authentication"},"Wikipedia"),". From within the ",(0,s.kt)("inlineCode",{parentName:"p"},"mfa")," function the following variables can be set:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"codePeriodSeconds")," specifies how many seconds a Time-based One-time Password (TOTP) remains valid. Default: 30 seconds."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"codePeriodDiscrepancy")," specifies the allowed discrepancy to the TOTP. 1 would mean a single block of each ",(0,s.kt)("inlineCode",{parentName:"li"},"codePeriodSeconds")," either side of the time window. Default: 1."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"codeDigits")," specifies the number of digits used in the TOTP. Default: 6 digits."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"hashingAlgorithm")," specifies which choice of Hashing Algorithm to use. Available choices are: ",(0,s.kt)("inlineCode",{parentName:"li"},"HashingFunction.SHA1"),", ",(0,s.kt)("inlineCode",{parentName:"li"},"HashingFunction.SHA256")," or ",(0,s.kt)("inlineCode",{parentName:"li"},"HashingFunction.SHA512"),". Default: ",(0,s.kt)("inlineCode",{parentName:"li"},"HashingFunction.SHA1"),"."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"issuer")," specifies a reference to the Organisation or Entity issuing the MFA. Default: Genesis."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"label")," specifies a label for the MFA. This is typically an email address of the issuing Entity or Organisation. Default: genesis.global."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"confirmWaitPeriodSecs")," specifies the period of time in seconds before a secret has to be confirmed. Default: 300 seconds."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"secretEncryptKey")," specifies a key with which Secrets will be encrypted in the database. If this is null or undefined Secrets will not be encrypted in the database. Default: null."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"usernameTableLookUpSalt")," specifies the salt with which a username is hashed, when stored in the database with the above Secret. If this is null or undefined the username will not be hashed in the database. Default: null.")),(0,s.kt)("h3",{id:"loginack"},"loginAck"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"loginAck")," function allows you to define additional values to be sent back to the client as part of the ",(0,s.kt)("inlineCode",{parentName:"p"},"LOGIN_ACK")," message. When you call the ",(0,s.kt)("inlineCode",{parentName:"p"},"loginAck")," function, you have to supply a table or view as a parameter. This is the table or view upon which the following functions will be invoked."),(0,s.kt)("h4",{id:"loadrecord"},"loadRecord"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"loadRecord")," function can be invoked within the ",(0,s.kt)("inlineCode",{parentName:"p"},"loginAck")," function to load a single record from the previously supplied table or view."),(0,s.kt)("h4",{id:"fields"},"fields"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"fields")," function can be invoked within the ",(0,s.kt)("inlineCode",{parentName:"p"},"loginAck")," function to specify which additional fields should be sent back to the client as part of the LOGIN_ACK message."),(0,s.kt)("h3",{id:"example"},"Example"),(0,s.kt)("p",null,"Example configuration:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-kotlin"},'import global.genesis.auth.manager.AuthType\nimport global.genesis.auth.manager.data.HashingFunction\nimport global.genesis.auth.manager.security.sso.jwt.NewUserMode\nimport global.genesis.db.entity.DbEntity\nimport global.genesis.dictionary.pal.view.IndexedDataStructure\nimport global.genesis.gen.config.tables.USER_ATTRIBUTES.ACCESS_TYPE\nimport global.genesis.gen.config.tables.USER_ATTRIBUTES.ADDRESS_LINE1\nimport global.genesis.gen.config.tables.USER_ATTRIBUTES.USER_TYPE\n\nsecurity {\n    sessionTimeoutMins = 30\n    expiryCheckMins = 5\n    maxSimultaneousUserLogins = 0\n\n    authentication {\n        type = AuthType.LDAP\n        url = "localhost"\n        port = 389\n        searchBase {\n            searchBase("ou=temp,dc=temp")\n        }\n        userGroups {\n        }\n        userPrefix = ""\n        bindDn = null\n        bindPassword = null\n        userIdType = "cn"\n    }\n\n    passwordValidation {\n        passwordSalt = ""\n        passwordStrength {\n            minimumLength = null\n            maximumLength = null\n            minDigits = null\n            maxRepeatCharacters = null\n            minUppercaseCharacters = null\n            minLowercaseCharacters = null\n            minNonAlphaNumericCharacters = null\n            restrictWhiteSpace = true\n            restrictAlphaSequences = false\n            restrictQWERTY = true\n            restrictNumericalSequences = true\n            illegalCharacters = "\\$\xa3^"\n            historicalCheck = 0\n            restrictDictionarySubstring = false\n            restrictUserName = false\n            repeatCharacterRestrictSize = null\n            passwordExpiryDays = null\n            passwordExpiryNotificationDays = null\n        }\n    }\n\n    passwordRetry {\n        maxAttempts = 3\n        waitTimeMins = 5\n    }\n\n    sso {\n        enabled = false\n        newUserMode = NewUserMode.REJECT\n    }\n\n    mfa {\n        codePeriodSeconds = 30\n        codePeriodDiscrepency = 1\n        codeDigits = 6\n        usernameTableLookUpSalt = null\n        secretEncryptKey = null\n        hashingAlgorithm = HashingFunction.SHA1\n        issuer = "Genesis"\n        label = "genesis.global"\n        confirmWaitPeriodSecs = 300\n    }\n\n    loginAck(USER_ATTRIBUTES) {\n        loadRecord { UserAttributes.byUserName(userName) }\n        fields {\n            USER_TYPE\n            ACCESS_TYPE withPrefix "USER"\n            ADDRESS_LINE1\n        }\n    }\n}\n')),(0,s.kt)("h2",{id:"message-flows"},"Message flows"),(0,s.kt)("p",null,"Security messages can be split into three categories."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Pre-authentication"),(0,s.kt)("li",{parentName:"ul"},"Authentication"),(0,s.kt)("li",{parentName:"ul"},"Post-authentication")),(0,s.kt)("p",null,"All requests below are capable of returning an error with a code of INTERNAL_ERROR, which will be used as a last resort."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"pre-authentication"},"Pre-authentication"),(0,s.kt)("p",null,"Pre-authentication messages can be sent by a client without the user being logged in."),(0,s.kt)("h4",{id:"login-preferences"},"Login preferences"),(0,s.kt)("p",null,"You need make sure that any connecting client knows the types of functionality that you have configured on the security module. For example, you could offer the client two ways of resetting user passwords: either via an administrator or by sending an email.  This choice can affect how the login dialog is displayed, so it is vital that the connecting client knows this before any user logs in.\nCurrently, this is the only preference published."),(0,s.kt)("h5",{id:"request"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_LOGIN_PREFS\n")),(0,s.kt)("h5",{id:"response"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_LOGIN_PREFS_ACK\n    DETAILS.PASSWORD_RESET_TYPE = ADMIN/EMAIL\n")),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"authentication-1"},"Authentication"),(0,s.kt)("p",null,"Once you have a list of preferences, you can show the correct login dialog and let the user make a login attempt.  The password is provided in plain text, as it is expected you will secure the connection using TLS."),(0,s.kt)("h4",{id:"login"},"Login"),(0,s.kt)("h5",{id:"request-1"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_LOGIN_AUTH\nDETAILS.USER_NAME = JohnDoe\nDETAILS.PASSWORD = Password123\n")),(0,s.kt)("h5",{id:"response-1"},"Response"),(0,s.kt)("p",null,"If successful:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_LOGIN_AUTH_ACK\nDETAILS.SYSTEM.DATE = 2014-06-18 12:27:01\nDETAILS.HEARTBEAT_INTERVAL_SECS = 30\nDETAILS.SYSTEM.PRODUCT[0].NAME = SBL\nDETAILS.SYSTEM.PRODUCT[0].VERSION = 1.0.0-RELEASE\nDETAILS.SYSTEM.PRODUCT[1].NAME = AUTH\nDETAILS.SYSTEM.PRODUCT[1].VERSION = 1.0.1.RELEASE\n")),(0,s.kt)("p",null,"If there is a problem, the server will return the standard error set with CODE/TEXT details and the error code ",(0,s.kt)("inlineCode",{parentName:"p"},"LOGIN_AUTH_NACK"),".  The following error codes can be provided:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"UNKNOWN_ACCOUNT")," - User is unknown"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"INCORRECT_CREDENTIALS")," - User/password combination is invalid"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"LOCKED_ACCOUNT")," - Account is locked and needs to be re-activated by administrator"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"PASSWORD_EXPIRED")," - Password must be changed"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"LOGIN_FAIL")," - Generic error code")),(0,s.kt)("h4",{id:"password-change"},"Password change"),(0,s.kt)("p",null,"If the response is ",(0,s.kt)("inlineCode",{parentName:"p"},"PASSWORD_EXPIRED"),", then the GUI can allow the user to change the password, provided they know their existing password."),(0,s.kt)("h5",{id:"request-2"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_CHANGE_USER_PASSWORD\nDETAILS.USER_NAME = JohnDoe\nDETAILS.OLD_PASSWORD = Password123\nDETAILS.NEW_PASSWORD = Password456\n")),(0,s.kt)("h5",{id:"response-2"},"Response"),(0,s.kt)("p",null,"If successful:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_CHANGE_USER_PASSWORD_ACK\n")),(0,s.kt)("p",null,"If there's a problem, you will receive a standard error set with type"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"CHANGE_USER_PASSWORD_NACK"),".  The error codes that can be returned are currently:"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"TOO_SHORT")," - Password length too short."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"TOO_LONG")," - Password length too long."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"INSUFFICIENT_CHARACTERS")," - Covers a few cases so text field may be required, used for things like no digits provided when 1 digit is required."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"ILLEGAL_MATCH")," - Covers a few cases so text field may be required, used for things like repeating characters in password."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"ILLEGAL_WHITESPACE")," - If password contains white space."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"INSUFFICIENT_CHARACTERISTICS"),' - May be provided if you have configured passwords to be successful if only 2 of 5.strength checks pass.  Should be provided alongside "real" error codes.'),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"ILLEGAL_SEQUENCE")," - Numerical/alphabetical sequence detected.")),(0,s.kt)("h4",{id:"reset-password"},"Reset password"),(0,s.kt)("p",null,"This can only be called by an administrator; it simply specifies a user name and sets the password to blank."),(0,s.kt)("h5",{id:"request-3"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_RESET_USER_PASSWORD\nDETAILS.USER_NAME = JohnDoe\n")),(0,s.kt)("h5",{id:"response-3"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_RESET_USER_PASSWORD_ACK\n")),(0,s.kt)("h3",{id:"post-authentication"},"Post-authentication"),(0,s.kt)("p",null,"Once the user has been authenticated, the server expects heartbeat messages, as defined in the interval setting on the ACK message.  If the GUI misses a configurable number of heartbeats, the session will be expired.  In response to a heartbeat, the GUI will receive a list of available services and their details."),(0,s.kt)("p",null,"These services should be contacted on the hosts in the order they are defined in the list.  The ordering may change if the server implements a load-balancing strategy.  Existing connections can simply ignore the ordering changes, but in a failover or reconnection scenario, the ordering should be adhered to."),(0,s.kt)("h5",{id:"request-4"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_HEARTBEAT\nUSER_NAME = JohnDoe\n")),(0,s.kt)("h5",{id:"response-4"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_HEARTBEAT_ACK\nDETAILS.SERVICE[0].NAME = SBL_EVENT_HANDLER\nDETAILS.SERVICE[0].ENCRYPTED = false\nDETAILS.SERVICE[0].HOST[0].NAME = genesisserv1\nDETAILS.SERVICE[0].HOST[0].PORT = 9001\nDETAILS.SERVICE[0].HOST[1].NAME = genesisserv2\nDETAILS.SERVICE[0].HOST[1].PORT = 9001\nDETAILS.SERVICE[1].NAME = SBL_DATA_SERVER\nDETAILS.SERVICE[1].ENCRYPTED = false\nDETAILS.SERVICE[1].HOST[0].NAME = genesisserv1\nDETAILS.SERVICE[1].HOST[0].PORT = 9002\nDETAILS.SERVICE[1].HOST[1].NAME = genesisserv2\nDETAILS.SERVICE[1].HOST[1].PORT = 9002\n")),(0,s.kt)("h4",{id:"rights-polling"},"Rights polling"),(0,s.kt)("p",null,"The GUI can receive rights from a process called ",(0,s.kt)("inlineCode",{parentName:"p"},"AUTH_DATASERVER"),". The view ",(0,s.kt)("inlineCode",{parentName:"p"},"USER_RIGHTS")," displays all users and codes. A logged-in user should automatically set the Filter expression to be ",(0,s.kt)("inlineCode",{parentName:"p"},"USER_NAME"),"=='xxx' to receive push updates to user privileges."),(0,s.kt)("h4",{id:"entity-management"},"Entity management"),(0,s.kt)("p",null,"In the Genesis low-code platform, there are profiles, users and rights.  A profile is a group of users, which can be permissioned.  For example, you could have a SALES_TRADER group in which all users must have the same permissions.  In all cases where you specify either a right for a user/profile, or a user in a profile, the event represents what you want the entity to look like; i.e. if you amend a profile and don't supply a user that previously was part of that profile, then that user will be removed from that profile on the server."),(0,s.kt)("p",null,"Note the following:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"2-phase validation is not currently supported"),(0,s.kt)("li",{parentName:"ul"},"metadata is not supported on the following transactions.\nUser/profile ",(0,s.kt)("inlineCode",{parentName:"li"},"STATUS")," field can be set to ",(0,s.kt)("inlineCode",{parentName:"li"},"ENABLED"),", ",(0,s.kt)("inlineCode",{parentName:"li"},"DISABLED"),", ",(0,s.kt)("inlineCode",{parentName:"li"},"PASSWORD_EXPIRED")," and ",(0,s.kt)("inlineCode",{parentName:"li"},"PASSWORD_RESET"),".\n",(0,s.kt)("inlineCode",{parentName:"li"},"PASSWORD_EXPIRED")," should prompt the user to enter a new password.\n",(0,s.kt)("inlineCode",{parentName:"li"},"PASSWORD_RESET"),' should do the same but the server expects a blank "current password" field.')),(0,s.kt)("h4",{id:"insert-profile"},"Insert profile"),(0,s.kt)("h5",{id:"request-5"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_INSERT_PROFILE\nUSER_NAME = JohnDoe\nDETAILS.NAME = SALES_TRADERS\nDETAILS.DESCRIPTION = Sales Traders\nDETAILS.STATUS = ENABLED\nDETAILS.RIGHT[0].ID = 00000000000001RISP0\nDETAILS.RIGHT[0].CODE = ORDEN\nDETAILS.RIGHT[1].ID = 00000000000002RISP0\nDETAILS.RIGHT[1].CODE = ORDAM\nDETAILS.USER[0].ID = 00000000000001USSP0\nDETAILS.USER[0].USER_NAME = JohnDoe\nDETAILS.USER[1].ID = 00000000000002USSP0\nDETAILS.USER[1].USER_NAME = james\n")),(0,s.kt)("h5",{id:"response-5"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_INSERT_PROFILE_ACK\n")),(0,s.kt)("h4",{id:"amend-profile"},"Amend Profile"),(0,s.kt)("h5",{id:"request-6"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_AMEND_PROFILE\nUSER_NAME = JohnDoe\nDETAILS.ID = 000000000001PRSP0\nDETAILS.NAME = SALES_TRADERS_AMEND\nDETAILS.DESCRIPTION = Sales Traders (Amended)\nDETAILS.STATUS = ENABLED\nDETAILS.RIGHT[0].ID = 00000000000001RISP0\nDETAILS.RIGHT[0].CODE = ORDEN\nDETAILS.RIGHT[1].ID = 00000000000002RISP0\nDETAILS.RIGHT[1].CODE = ORDAM\nDETAILS.RIGHT[2].ID = 00000000000003RISP0\nDETAILS.RIGHT[2].CODE = ORDEL\nDETAILS.USER[0].ID = 00000000000001USSP0\nDETAILS.USER[0].USER_NAME = JohnDoe\n")),(0,s.kt)("h5",{id:"response-6"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_AMEND_PROFILE_ACK\n")),(0,s.kt)("h4",{id:"delete-profile"},"Delete Profile"),(0,s.kt)("h5",{id:"request-7"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_DELETE_PROFILE\nUSER_NAME = JohnDoe\nDETAILS.NAME = SALES_TRADERS\n")),(0,s.kt)("h5",{id:"response-7"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_DELETE_PROFILE_ACK\n")),(0,s.kt)("h4",{id:"insert-user"},"Insert User"),(0,s.kt)("h5",{id:"request-8"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_INSERT_USER\nUSER_NAME = mthompson\nDETAILS.USER_NAME = JohnDoe\nDETAILS.FIRST_NAME = John\nDETAILS.LAST_NAME = Doe\nDETAILS.EMAIL_ADDRESS = john.doe@genesis.global\nDETAILS.STATUS = ENABLED\nDETAILS.RIGHT[0].ID = 00000000000001RISP0\nDETAILS.RIGHT[0].CODE = ORDEN\nDETAILS.RIGHT[1].ID = 00000000000002RISP0\nDETAILS.RIGHT[1].CODE = ORDAM\n")),(0,s.kt)("h5",{id:"response-8"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_INSERT_USER_ACK\n")),(0,s.kt)("h4",{id:"amend-user"},"Amend User"),(0,s.kt)("h5",{id:"request-9"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_AMEND_USER\nUSER_NAME = mthompson\nDETAILS.ID = 00000000000001USSP0\nDETAILS.USER_NAME = JohnDoe\nDETAILS.FIRST_NAME = John\nDETAILS.LAST_NAME = Doe\nDETAILS.EMAIL_ADDRESS = john.doe@genesis.global\nDETAILS.STATUS = ENABLED\nDETAILS.RIGHT[0].ID = 00000000000001RISP0\nDETAILS.RIGHT[0].CODE = ORDEN\nDETAILS.RIGHT[1].ID = 00000000000002RISP0\nDETAILS.RIGHT[1].CODE = ORDAM\n")),(0,s.kt)("h5",{id:"response-9"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_AMEND_USER_ACK\n")),(0,s.kt)("h4",{id:"delete-user"},"Delete User"),(0,s.kt)("h5",{id:"request-10"},"Request"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_DELETE_USER\nUSER_NAME = JohnDoe\nDETAILS.USER_NAME = james\n")),(0,s.kt)("h5",{id:"response-10"},"Response"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"MESSAGE_TYPE = EVENT_DELETE_USER_ACK\n")))}h.isMDXComponent=!0}}]);