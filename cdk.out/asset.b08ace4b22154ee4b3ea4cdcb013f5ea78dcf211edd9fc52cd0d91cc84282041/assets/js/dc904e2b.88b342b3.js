"use strict";(self.webpackChunk_genesislcap_docs=self.webpackChunk_genesislcap_docs||[]).push([[411],{64151:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return r},default:function(){return h},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return u}});var a=n(87462),i=n(63366),l=(n(67294),n(3905)),o=(n(61839),["components"]),s={title:"Go to the next level - Define the data model using fields, tables and views",sidebar_label:"Fields, tables and views",id:"data-model",keywords:["getting started","quick start","next level","data model","fields","tables","views"],tags:["getting started","quick start","next level","introduction","data model","fields","tables","views"]},r=void 0,d={unversionedId:"getting-started/go-to-the-next-level/data-model",id:"version-2022.3/getting-started/go-to-the-next-level/data-model",title:"Go to the next level - Define the data model using fields, tables and views",description:"Following on from project creation in the previous step, you have:",source:"@site/versioned_docs/version-2022.3/01_getting-started/03_go-to-the-next-level/02_data-model.md",sourceDirName:"01_getting-started/03_go-to-the-next-level",slug:"/getting-started/go-to-the-next-level/data-model",permalink:"/getting-started/go-to-the-next-level/data-model",draft:!1,tags:[{label:"getting started",permalink:"/tags/getting-started"},{label:"quick start",permalink:"/tags/quick-start"},{label:"next level",permalink:"/tags/next-level"},{label:"introduction",permalink:"/tags/introduction"},{label:"data model",permalink:"/tags/data-model"},{label:"fields",permalink:"/tags/fields"},{label:"tables",permalink:"/tags/tables"},{label:"views",permalink:"/tags/views"}],version:"2022.3",sidebarPosition:2,frontMatter:{title:"Go to the next level - Define the data model using fields, tables and views",sidebar_label:"Fields, tables and views",id:"data-model",keywords:["getting started","quick start","next level","data model","fields","tables","views"],tags:["getting started","quick start","next level","introduction","data model","fields","tables","views"]},sidebar:"learningSidebar",previous:{title:"Introduction",permalink:"/getting-started/go-to-the-next-level/introduction"},next:{title:"Add some data",permalink:"/getting-started/go-to-the-next-level/add-some-data"}},p={},u=[{value:"Section objectives",id:"section-objectives",level:2},{value:"1. Add fields",id:"1-add-fields",level:2},{value:"Generate the fields",id:"generate-the-fields",level:3},{value:"2. Add tables",id:"2-add-tables",level:2},{value:"Generate the data objects",id:"generate-the-data-objects",level:3},{value:"3. Add view",id:"3-add-view",level:2},{value:"Generate the view",id:"generate-the-view",level:3},{value:"Entities",id:"entities",level:2},{value:"Conclusion",id:"conclusion",level:2}],m={toc:u};function h(e){var t=e.components,s=(0,i.Z)(e,o);return(0,l.kt)("wrapper",(0,a.Z)({},m,s,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Following on from project creation in the previous step, you have:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"i Application created successfully! \ud83c\udf89 Please open the application and follow the README to complete setup.\n")),(0,l.kt)("p",null,"Now you are ready to define the fields and tables that make up the data model. "),(0,l.kt)("p",null,"Start IntelliJIDEA (or your chosen IDE) and then open the ",(0,l.kt)("inlineCode",{parentName:"p"},"positions-app-tutorial")," project. This triggers importing and indexing of the files (which takes about as long as ",(0,l.kt)("a",{parentName:"p",href:"https://youtu.be/jVHhV3A5C5c"},"Hotel California"),", so be patient). After that, you will see the files and the project structure displayed in your IDE."),(0,l.kt)("h2",{id:"section-objectives"},"Section objectives"),(0,l.kt)("p",null,"The goal of this section is to define and build our database fields, tables and views."),(0,l.kt)("h2",{id:"1-add-fields"},"1. Add fields"),(0,l.kt)("p",null,"The fields are defined in the file ",(0,l.kt)("strong",{parentName:"p"},"positions-app-tutorial-fields-dictionary.kts")),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"Once the project is open, there are two easy ways to find this file quickly in IntelliJIDEA:"),(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"Press the ",(0,l.kt)("strong",{parentName:"li"},"Shift")," key twice, then type the name of the file you are looking for."),(0,l.kt)("li",{parentName:"ul"},"Press ",(0,l.kt)("strong",{parentName:"li"},"Shift")," + ",(0,l.kt)("strong",{parentName:"li"},"Ctrl")," + ",(0,l.kt)("strong",{parentName:"li"},"N"),", then type the name of the file you are looking for."))),(0,l.kt)("p",null,"For this application, we need fields that model a Trade, Position and Company; to do that, we'll add the following:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-kotlin"},'fields {\n    // Trade\n    field(name = "ENTERED_BY", type = STRING)\n    field(name = "PRICE", type = DOUBLE)\n    field(name = "QUANTITY", type = LONG)\n    field(name = "REFERENCE_PX", type = STRING)\n    field(name = "REFERENCE_QTY", type = DOUBLE)\n    field(name = "SIDE", type = STRING)\n    field(name = "SYMBOL", type = LONG)\n    field(name = "TRADE_DATE", type = DATE)\n    field(name = "TRADE_DATETIME", type = DATETIME)\n    field(name = "TRADE_ID", type = STRING)\n    field(name = "TRADE_STATUS", type = ENUM("NEW", "ALLOCATED", "CANCELLED", default = "NEW"))\n\n    // Position\n    field(name = "POSITION_ID", type = STRING)\n    field(name = "QUANTITY", type = LONG) // total number of shares\n    field(name = "VALUE", type = DOUBLE) // position qty multiplied by avg trade price\n    field(name = "NOTIONAL", type = DOUBLE) // instrument price multiplied by quantity\n    field(name = "PNL", type = DOUBLE) // difference between notional and current market price\n\n    // Company\n    field(name = "COMPANY_NAME", type = STRING)\n    field(name = "COMPANY_LOCATION", type = STRING)\n\n    // Instrument\n    field(name = "INSTRUMENT_ID", type = STRING)\n    field(name = "INSTRUMENT_SYMBOL", type = STRING)\n    field(name = "CURRENCY_ID", type = STRING)\n\n    // Counterparty\n    field(name = "COUNTERPARTY_NAME", type = STRING)\n    field(name = "COUNTERPARTY_ID", type = STRING)\n}\n')),(0,l.kt)("h3",{id:"generate-the-fields"},"Generate the fields"),(0,l.kt)("p",null,"After you have saved this file, run ",(0,l.kt)("inlineCode",{parentName:"p"},"generateFields"),"."),(0,l.kt)("p",null,"From the Gradle menu on the right of Intellij, this is:"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"genesisproduct-positions-app-tutorial"),"/",(0,l.kt)("strong",{parentName:"p"},"positions-app-tutorial-dictionary-cache"),"/",(0,l.kt)("strong",{parentName:"p"},"genesis-generated-fields"),"/",(0,l.kt)("strong",{parentName:"p"},"Tasks"),"/",(0,l.kt)("strong",{parentName:"p"},"genesis"),"/",(0,l.kt)("strong",{parentName:"p"},"generateFields")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(75089).Z,width:"421",height:"474"})),(0,l.kt)("admonition",{title:"Why do I have to run this Gradle task?",type:"note"},(0,l.kt)("p",{parentName:"admonition"},"You are editing a kts file that will be compiled and built for use in other places. In this case, we want the fields to be available to the tables (and with intellisense support from the IDE)."),(0,l.kt)("p",{parentName:"admonition"},"As we go, you'll see we have different Gradle tasks, depending on the artifact we want to build.")),(0,l.kt)("h2",{id:"2-add-tables"},"2. Add tables"),(0,l.kt)("p",null,"Now that we have our fields, let's define the tables in the file ",(0,l.kt)("strong",{parentName:"p"},"positions-app-tutorial-tables-dictionary.kts"),".\nWe shall define four tables, ",(0,l.kt)("inlineCode",{parentName:"p"},"TRADE"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"POSITION"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"COUNTERPARTY")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"INSTRUMENT"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-kotlin"},'tables {\n    table (name = "TRADE", id = 11000) {\n        sequence(TRADE_ID, "TR")\n        INSTRUMENT_ID not null\n        COUNTERPARTY_ID not null\n        QUANTITY not null\n        SIDE not null\n        PRICE not null\n        TRADE_DATETIME\n        ENTERED_BY\n        TRADE_STATUS\n\n        primaryKey {\n            TRADE_ID\n        }\n    }\n\n    table(name= "POSITION", id = 11001) {\n        sequence(POSITION_ID, "PS")\n        INSTRUMENT_ID not null\n        QUANTITY\n        NOTIONAL\n        VALUE\n        PNL\n\n        primaryKey {\n            POSITION_ID\n        }\n\n        indices {\n            unique {\n                INSTRUMENT_ID\n            }\n        }\n    }\n\n    table( name = "COUNTERPARTY", id = 11003) {\n        COUNTERPARTY_ID\n        COUNTERPARTY_NAME\n\n        primaryKey {\n            COUNTERPARTY_ID\n        }\n    }\n\n    table (name = "INSTRUMENT", id = 11004) {\n        INSTRUMENT_ID\n        INSTRUMENT_SYMBOL\n        CURRENCY_ID\n\n        primaryKey {\n            INSTRUMENT_ID\n        }\n    }\n}\n')),(0,l.kt)("h3",{id:"generate-the-data-objects"},"Generate the data objects"),(0,l.kt)("p",null,"After you have saved the file of tables, run ",(0,l.kt)("inlineCode",{parentName:"p"},"generateDao")),(0,l.kt)("p",null,"From the Gradle menu, this is:"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"genesisproduct-positions-app-tutorial"),"/",(0,l.kt)("strong",{parentName:"p"},"positions-app-tutorial-dictionary-cache"),"/",(0,l.kt)("strong",{parentName:"p"},"genesis-generated-dao"),"/",(0,l.kt)("strong",{parentName:"p"},"Tasks"),"/",(0,l.kt)("strong",{parentName:"p"},"genesis"),"/",(0,l.kt)("strong",{parentName:"p"},"generateDAO")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(59395).Z,width:"421",height:"474"})),(0,l.kt)("p",null,"This script generates the DAOs (data repos) from the tables, and they are available to be imported in your code."),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"As we previously generated the fields, autocompletion helps you to define the tables more quickly, and with fewer errors. Also note that Genesis provides several autogenerated primary keys: ",(0,l.kt)("strong",{parentName:"p"},"sequence"),", ",(0,l.kt)("strong",{parentName:"p"},"uuid"),", ",(0,l.kt)("strong",{parentName:"p"},"autoincrement"),".")),(0,l.kt)("h2",{id:"3-add-view"},"3. Add view"),(0,l.kt)("p",null,"When you set up a data model, it implies relationships between tables. For example, a ",(0,l.kt)("inlineCode",{parentName:"p"},"TRADE")," has a ",(0,l.kt)("inlineCode",{parentName:"p"},"COUNTERPARTY_ID")," and an ",(0,l.kt)("inlineCode",{parentName:"p"},"INSTRUMENT_ID"),". That means it has a relationship with the ",(0,l.kt)("inlineCode",{parentName:"p"},"COUNTERPARTY")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"INSTRUMENT")," tables."),(0,l.kt)("p",null,"Views enable you to join related tables to create a single holistic view."),(0,l.kt)("p",null,"In short, views are the Genesis equivalent of SQL select queries. Unlike tables, views do not have any data of their own, they are read-only, but they present a view based on one or more tables. "),(0,l.kt)("p",null,"A view always starts with a single table, the root table. Other tables can be joined onto the root table to present composite data. "),(0,l.kt)("p",null,"Views are very powerful and here we are going to cover just the basics. When you have a chance, have a look at the ",(0,l.kt)("a",{parentName:"p",href:"/database/fields-tables-views/views/"},"documentation"),"."),(0,l.kt)("p",null,"The code below creates a view called ",(0,l.kt)("inlineCode",{parentName:"p"},"TRADE_VIEW"),", which joins the ",(0,l.kt)("inlineCode",{parentName:"p"},"TRADE")," table to the ",(0,l.kt)("inlineCode",{parentName:"p"},"INSTRUMENT")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"COUNTERPARTY")," tables. Edit ",(0,l.kt)("strong",{parentName:"p"},"positions-app-tutorial\u2013view-dictionary.kts")," file and add the view on the ",(0,l.kt)("inlineCode",{parentName:"p"},"TRADE")," table:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-kotlin"},'views {\n\n    view("TRADE_VIEW", TRADE) {\n\n        joins {\n            joining(COUNTERPARTY) {\n                on(TRADE.COUNTERPARTY_ID to COUNTERPARTY { COUNTERPARTY_ID })\n            }\n            joining(INSTRUMENT) {\n                on(TRADE.INSTRUMENT_ID to INSTRUMENT { INSTRUMENT_ID })\n            }\n        }\n\n        fields {\n            TRADE.allFields()\n\n            COUNTERPARTY.COUNTERPARTY_NAME withPrefix COUNTERPARTY\n            INSTRUMENT.INSTRUMENT_SYMBOL withPrefix INSTRUMENT\n            INSTRUMENT.CURRENCY_ID withAlias "CURRENCY"\n        }\n    }\n}\n')),(0,l.kt)("h3",{id:"generate-the-view"},"Generate the view"),(0,l.kt)("p",null,"After you have saved the view file, run ",(0,l.kt)("inlineCode",{parentName:"p"},"generateView")),(0,l.kt)("p",null,"From the Gradle menu, this is:"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"genesisproduct-positions-app-tutorial"),"/",(0,l.kt)("strong",{parentName:"p"},"positions-app-tutorial-dictionary-cache"),"/",(0,l.kt)("strong",{parentName:"p"},"genesis-generated-view"),"/",(0,l.kt)("strong",{parentName:"p"},"Tasks"),"/",(0,l.kt)("strong",{parentName:"p"},"genesis"),"/",(0,l.kt)("strong",{parentName:"p"},"generateView")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(53759).Z,width:"421",height:"474"})),(0,l.kt)("h2",{id:"entities"},"Entities"),(0,l.kt)("p",null,"During code generation, ",(0,l.kt)("a",{parentName:"p",href:"/database/data-structures/views/"},"view")," and ",(0,l.kt)("a",{parentName:"p",href:"/database/data-structures/indices/"},"index entities")," will be generated from the definitions in your application's ",(0,l.kt)("strong",{parentName:"p"},"view-dictionary.kts")," file. The name of each entity will be the same as the definition, but it is converted from snake case to camel case; for example, VIEW_NAME becomes ViewName."),(0,l.kt)("h2",{id:"conclusion"},"Conclusion"),(0,l.kt)("p",null,"With this, our data model is defined. As a next step, we shall add some data to the tables in the database."))}h.isMDXComponent=!0},75089:function(e,t,n){t.Z=n.p+"assets/images/build-gradle-kts-fields-positions-24a82352eb22cc47a71e1a02318f1f62.png"},59395:function(e,t,n){t.Z=n.p+"assets/images/build-gradle-kts-generated-dao-positions-07b5838acf0025d7d174d16a6ae680f0.png"},53759:function(e,t,n){t.Z=n.p+"assets/images/build-gradle-kts-generated-view-positions-67dd43268c1e3787a21f630e0e6ed40c.png"}}]);