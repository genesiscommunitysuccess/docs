"use strict";(self.webpackChunk_genesislcap_docs=self.webpackChunk_genesislcap_docs||[]).push([[61186],{17150:function(e,a,t){t.r(a),t.d(a,{assets:function(){return m},contentTitle:function(){return l},default:function(){return g},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return c}});var n=t(87462),r=t(63366),i=(t(67294),t(3905)),s=(t(61839),["components"]),o={title:"Apache Camel - Examples",sidebar_label:"Examples",id:"examples",keywords:["server","integration","apache camel","examples"],tags:["server","integration","apache camel","examples"]},l=void 0,p={unversionedId:"server/integration/apache-camel/examples",id:"server/integration/apache-camel/examples",title:"Apache Camel - Examples",description:"Introduction  | Basics | Advanced | Examples | Configuring runtime | Testing",source:"@site/docs/03_server/10_integration/10_apache-camel/04_examples.md",sourceDirName:"03_server/10_integration/10_apache-camel",slug:"/server/integration/apache-camel/examples",permalink:"/next/server/integration/apache-camel/examples",draft:!1,tags:[{label:"server",permalink:"/next/tags/server"},{label:"integration",permalink:"/next/tags/integration"},{label:"apache camel",permalink:"/next/tags/apache-camel"},{label:"examples",permalink:"/next/tags/examples"}],version:"current",sidebarPosition:4,frontMatter:{title:"Apache Camel - Examples",sidebar_label:"Examples",id:"examples",keywords:["server","integration","apache camel","examples"],tags:["server","integration","apache camel","examples"]},sidebar:"serverModulesSidebar",previous:{title:"Advanced",permalink:"/next/server/integration/apache-camel/advanced"},next:{title:"Configuring Runtime",permalink:"/next/server/integration/apache-camel/configuring-runtime"}},m={},c=[{value:"Reading from an SFTP server",id:"reading-from-an-sftp-server",level:2},{value:"Writing to an SFTP server",id:"writing-to-an-sftp-server",level:2}],d={toc:c};function g(e){var a=e.components,t=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/server/integration/apache-camel/introduction/"},"Introduction"),"  | ",(0,i.kt)("a",{parentName:"p",href:"/server/integration/apache-camel/basics"},"Basics")," | ",(0,i.kt)("a",{parentName:"p",href:"/server/integration/apache-camel/advanced"},"Advanced")," | ",(0,i.kt)("a",{parentName:"p",href:"/server/integration/apache-camel/examples"},"Examples")," | ",(0,i.kt)("a",{parentName:"p",href:"/server/integration/apache-camel/configuring-runtime"},"Configuring runtime")," | ",(0,i.kt)("a",{parentName:"p",href:"/server/integration/apache-camel/testing"},"Testing")),(0,i.kt)("h2",{id:"reading-from-an-sftp-server"},"Reading from an SFTP server"),(0,i.kt)("p",null,"The example below defines an ",(0,i.kt)("a",{parentName:"p",href:"https://camel.apache.org/components/3.16.x/sftp-component.html"},"SFTP component"),", and shows how you can use properties set in the ",(0,i.kt)("em",{parentName:"p"},"application-name"),(0,i.kt)("strong",{parentName:"p"},"-camel.kts"),", allowing you to have site-specific variables for each instance."),(0,i.kt)("p",null,"This is particularly useful when integrating with external services where connection details are likely to vary between environments."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'camel {\n    routeHandler {\n        val bbgEndPointPath = systemDefinition.getItem("BBG_SERVER_SFTP")\n        val bbgUserName = systemDefinition.getItem("BBG_SERVER_USERNAME")\n        val bbgPassword = systemDefinition.getItem("BBG_SERVER_PASSWORD")\n        val bbgFileName = systemDefinition.getItem("BBG_SERVER_FILENAME")\n        val pathStr = "${GenesisPaths.genesisHome()}/runtime/inbound"\n        val bbgConsumerRepo = "${pathStr}/IDEMPOTENT_CONSUMER.DATA"\n\n        from("sftp:${bbgEndPointPath}?username=${bbgUserName}&password=${bbgPassword}&include=$${bbgFileName}" +\n            "&delay=1000&sortBy=file:modified&delete=false&bridgeErrorHandler=true" +\n            "&knownHostsFile=/home/priss/.ssh/known_hosts&throwExceptionOnConnectFailed=true&stepwise=false")\n            .idempotentConsumer(header("CamelFileName"),\n                FileIdempotentRepository.fileIdempotentRepository(File(bbgConsumerRepo), 300000, 15000000))\n            .process { exchange ->\n                LOG.debug("SFTP copy CamelFileName = ${exchange.`in`.getHeader("CamelFileNameOnly").toString()}")\n            }\n            .log("BBG file transfer: \\${headers.CamelFileName}")\n            .to("file:${pathStr}/bbg")\n    }\n}\n')),(0,i.kt)("h2",{id:"writing-to-an-sftp-server"},"Writing to an SFTP server"),(0,i.kt)("p",null,"We can easily invert the above example and instead write files from a local directory to a remote SFTP server.\nWhile the paths and properties below would need to be replaced with appropriate values (be they hardcoded or derived from system definition items) the example below shows how simple the basic routing can be:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'camel {\n    routeHandler {\n        from("file:/directory/to/watch")\n        .to("sftp://remote-host:22/remote-path?username=user&password=pass")\n    }\n}\n')),(0,i.kt)("p",null,"For further details and configuration options see, the Apache Camel ",(0,i.kt)("a",{parentName:"p",href:"https://camel.apache.org/components/3.16.x/sftp-component.html"},"SFTP component")," documentation."))}g.isMDXComponent=!0}}]);