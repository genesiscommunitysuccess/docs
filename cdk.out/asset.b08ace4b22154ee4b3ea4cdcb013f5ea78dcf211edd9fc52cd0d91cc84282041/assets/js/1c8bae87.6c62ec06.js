"use strict";(self.webpackChunk_genesislcap_docs=self.webpackChunk_genesislcap_docs||[]).push([[99118],{67946:function(e,n,t){t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return o},default:function(){return T},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return d}});var a=t(87462),r=t(63366),s=(t(67294),t(3905)),i=(t(61839),["components"]),l={title:"REST endpoints - Basics",sidebar_label:"Basics",id:"basics",keywords:["server","integration","REST endpoints","basics"],tags:["server","integration","REST endpoints","basics"]},o=void 0,p={unversionedId:"server/integration/rest-endpoints/basics",id:"version-2022.3/server/integration/rest-endpoints/basics",title:"REST endpoints - Basics",description:"Introduction | Where to define | Basics | Advanced | Configuring runtime | Testing",source:"@site/versioned_docs/version-2022.3/03_server/10_integration/01_rest-endpoints/03_basics.md",sourceDirName:"03_server/10_integration/01_rest-endpoints",slug:"/server/integration/rest-endpoints/basics",permalink:"/server/integration/rest-endpoints/basics",draft:!1,tags:[{label:"server",permalink:"/tags/server"},{label:"integration",permalink:"/tags/integration"},{label:"REST endpoints",permalink:"/tags/rest-endpoints"},{label:"basics",permalink:"/tags/basics"}],version:"2022.3",sidebarPosition:3,frontMatter:{title:"REST endpoints - Basics",sidebar_label:"Basics",id:"basics",keywords:["server","integration","REST endpoints","basics"],tags:["server","integration","REST endpoints","basics"]},sidebar:"serverModulesSidebar",previous:{title:"Where to Define",permalink:"/server/integration/rest-endpoints/where-to-define"},next:{title:"Advanced",permalink:"/server/integration/rest-endpoints/advanced"}},u={},d=[{value:"Authentication",id:"authentication",level:2},{value:"EVENT_LOGIN_AUTH",id:"event_login_auth",level:3},{value:"Data Server",id:"data-server",level:2},{value:"DATA_LOGON",id:"data_logon",level:3},{value:"QUERY_UPDATE",id:"query_update",level:3},{value:"CHANGE_COLUMNS",id:"change_columns",level:3},{value:"MORE_ROWS",id:"more_rows",level:3},{value:"DATA_LOGOFF",id:"data_logoff",level:3},{value:"Request Server",id:"request-server",level:2},{value:"Event Handler",id:"event-handler",level:2}],E={toc:d};function T(e){var n=e.components,t=(0,r.Z)(e,i);return(0,s.kt)("wrapper",(0,a.Z)({},E,t,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"/server/integration/rest-endpoints/introduction/"},"Introduction")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/integration/rest-endpoints/where-to-define"},"Where to define")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/integration/rest-endpoints/basics/"},"Basics")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/integration/rest-endpoints/advanced/"},"Advanced")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/integration/rest-endpoints/configuring-runtime/"},"Configuring runtime")," | ",(0,s.kt)("a",{parentName:"p",href:"/server/integration/rest-endpoints/testing/"},"Testing")),(0,s.kt)("h2",{id:"authentication"},"Authentication"),(0,s.kt)("p",null,"As mentioned in the introduction, all requests to all Genesis components require you to have done an intial log in and to have retrieved the ",(0,s.kt)("inlineCode",{parentName:"p"},"SESSION_AUTH_TOKEN"),"."),(0,s.kt)("h3",{id:"event_login_auth"},"EVENT_LOGIN_AUTH"),(0,s.kt)("p",null,"Log in requests are submitted via POST requests to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/event-login-auth"),"."),(0,s.kt)("p",null,"Intial login requests require:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"USER_NAME")," and ",(0,s.kt)("inlineCode",{parentName:"li"},"PASSWORD")," keys in the ",(0,s.kt)("inlineCode",{parentName:"li"},"DETAILS")," object"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SOURCE_REF")," header.")),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'POST /event-login-auth HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSOURCE_REF: 123456-789041\n\n{\n    "DETAILS": {\n        "USER_NAME": "JaneDee",\n        "PASSWORD": "beONneON*74"\n    }\n}\n')),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "EVENT_LOGIN_AUTH_ACK",\n    "SESSION_AUTH_TOKEN": "y9lNIRTax0pmTdUN0XC1PgVl32KuXGsf",\n    "REFRESH_AUTH_TOKEN": "FmqF9CGzo2MiujEZoiRUjGXh8ybDC62L",\n    "SESSION_ID": "3f0203a5-e89d-4245-9e8b-c21fb0bcacd9",\n    "USER_ID": "",\n    "DETAILS": {\n        "SYSTEM": {\n            "DATE": "Sun Jan 21 20:53:44 UTC 2018"\n        },\n        "HEARTBEAT_INTERVAL_SECS": 30,\n        "FAILED_LOGIN_ATTEMPTS": 0,\n        "REJECTED_LOGIN_ATTEMPTS": 0,\n        "LAST_LOGIN_DATETIME": 1516567765917,\n        "PRODUCT": [\n            {\n                "NAME": "dta",\n                "VERSION": "2.2.2"\n            },\n            {\n                "NAME": "auth",\n                "VERSION": "1.1.1"\n            }\n        ]\n    },\n    "SOURCE_REF": "123456-789041"\n}\n')),(0,s.kt)("p",null,"Now that the ",(0,s.kt)("inlineCode",{parentName:"p"},"SESSION_AUTH_TOKEN")," has been returned, you must add it to every future request, except ",(0,s.kt)("inlineCode",{parentName:"p"},"EVENT_LOGIN_REFRESH")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"EVENT_LOGOUT"),": more on that later. "),(0,s.kt)("h2",{id:"data-server"},"Data Server"),(0,s.kt)("p",null,"Data Servers are the most complex of the REST Endpoints provided by the Genesis low-code platform; HTTP requests can only have a single response, but the Data Server enables you to publish a continuous stream of data to a subscribing client."),(0,s.kt)("p",null,"For all Data Server requests, a ",(0,s.kt)("inlineCode",{parentName:"p"},"SOURCE_REF")," header is mandatory, as it is used to match requests to the correct client subscription. This in turn allows for multiple subscriptions to the same query for the same session (think multiple grids in the UI using the same query with different filters)."),(0,s.kt)("p",null,"There follows a list of Data Server messages mapped to HTTP endpoints."),(0,s.kt)("h3",{id:"data_logon"},"DATA_LOGON"),(0,s.kt)("p",null,"To initiate a Data Server query, a DATA_LOGON message is required to create the subscription. This is requested via a POST request to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/[data_server_query_name]"),"."),(0,s.kt)("p",null,"A body is optional; if provided, it can contain Data Server parameters, such as ",(0,s.kt)("inlineCode",{parentName:"p"},"MAX_ROWS")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"FIELDS")),(0,s.kt)("p",null,"The response contains the initial set of data for the subscription. The ",(0,s.kt)("inlineCode",{parentName:"p"},"ROW_REF")," is a unique handle to each row returned and will be present on all QUERY_UPDATE requests where the given row has changed (e.g. modify/delete)."),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"To avoid memory leaks, the server will timeout subscriptions that have not been active for a period of time (no GET or PUT requests received). At this point, a new subscription can be made via a new DATA_LOGON request")),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'POST /my-trades HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSOURCE_REF: 123456-789031\nSESSION_AUTH_TOKEN: 83eLYBnlqjIWt1tqtJhKwTXJj2IL2WA0\n\n{\n  "DETAILS": {\n    "MAX_ROWS" : "3",\n    "FIELDS": "TRADE_ID CURRENCY FULLY_FILLED PRICE"\n  }\n}\n')),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "QUERY_UPDATE",\n    "ROW": [\n        {\n            "CURRENCY": "FGF",\n            "FULLY_FILLED": true,\n            "PRICE": 4856734,\n            "TRADE_ID": "000000000000109TRLO1",\n            "DETAILS": {\n                "OPERATION": "INSERT",\n                "ROW_REF": 1516923055488004380\n            }\n        },\n        {\n            "CURRENCY": "GBX",\n            "FULLY_FILLED": false,\n            "PRICE": 56548,\n            "TRADE_ID": "000000000000108TRLO1",\n            "DETAILS": {\n                "OPERATION": "INSERT",\n                "ROW_REF": 1516923055487676624\n            }\n        },\n        {\n            "CURRENCY": "USD",\n            "FULLY_FILLED": false,\n            "PRICE": 2.33,\n            "TRADE_ID": "000000000000107TRLO1",\n            "DETAILS": {\n                "OPERATION": "INSERT",\n                "ROW_REF": 1516923055486415809\n            }\n        }\n    ],\n    "SOURCE_REF": "123456-789031"\n}\n')),(0,s.kt)("h3",{id:"query_update"},"QUERY_UPDATE"),(0,s.kt)("p",null,"To poll for updates to the given subscription to a Data Server query, you need to send a QUERY_UPDATE message. This is requested via a GET request to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/[data_server_query_name]"),"."),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"SOURCE_REF")," should match that used in the original DATA_LOGON (subscription)."),(0,s.kt)("p",null,"The response contains the update of data (new/modified/deleted rows since the last update). The ",(0,s.kt)("inlineCode",{parentName:"p"},"ROW_REF")," value is used to reference the given row previously returned. An empty QUERY_UPDATE response means there was no change to the underlying data since the last request."),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},"GET /my-trades HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSOURCE_REF: 123456-789031\nSESSION_AUTH_TOKEN: 83eLYBnlqjIWt1tqtJhKwTXJj2IL2WA0\n")),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "QUERY_UPDATE",\n    "ROW": [\n        {\n            "DETAILS": {\n                "OPERATION": "DELETE",\n                "ROW_REF": 1516923055488004380\n            }\n        },\n        {\n            "PRICE": 56549\n            "DETAILS": {\n                "OPERATION": "MODIFY",\n                "ROW_REF": 1516923055487676624\n            }\n        },\n        {\n            "CURRENCY": "GBP",\n            "FULLY_FILLED": false,\n            "PRICE": 2.45,\n            "TRADE_ID": "000000000000201TRLO1",\n            "DETAILS": {\n                "OPERATION": "INSERT",\n                "ROW_REF": 1516923055486415912\n            }\n        }\n    ],\n    "SOURCE_REF": "123456-789031"\n}\n')),(0,s.kt)("h3",{id:"change_columns"},"CHANGE_COLUMNS"),(0,s.kt)("p",null,"It is possible to change the columns supplied on updates to the given subscription to a Data Server query."),(0,s.kt)("p",null,"This is requested via a PUT request to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/[data_server_query_name]"),"."),(0,s.kt)("p",null,"This particular message is slightly different from other Data Server messages; specifically, the ",(0,s.kt)("inlineCode",{parentName:"p"},"SOURCE_REF")," should be unique. A ",(0,s.kt)("inlineCode",{parentName:"p"},"SUBSCRIPTION_REF")," is also needed and must match that ",(0,s.kt)("inlineCode",{parentName:"p"},"SOURCE_REF")," value used in the original DATA_LOGON (subscription). The reason for the change in this message is that the response is a simple ACK/NACK, and the client should use this to know if it was successful or not. If an ACK is received, a further GET for the original ",(0,s.kt)("inlineCode",{parentName:"p"},"SOURCE_REF")," (this request's ",(0,s.kt)("inlineCode",{parentName:"p"},"SUBSCRIPTION_REF"),") will provide the added columns for each row the client has received, but nothing regarding the deleted columns. So the ACK is a means of telling the client it is OK to remove the deleted columns from the UI."),(0,s.kt)("p",null,"The body of this request should contain a ",(0,s.kt)("inlineCode",{parentName:"p"},"DETAILS")," object with ",(0,s.kt)("inlineCode",{parentName:"p"},"ADD_COLUMNS")," (further replies should include these columns) and/or ",(0,s.kt)("inlineCode",{parentName:"p"},"DROP_COLUMNS")," (further replies should not include these columns)"),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'PUT /my-trades HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSOURCE_REF: 123456-789032\nSESSION_AUTH_TOKEN: 83eLYBnlqjIWt1tqtJhKwTXJj2IL2WA0\nSUBSCRIPTION_REF: 123456-789031\n\n{\n  "DETAILS": {\n    "ADD_COLUMNS": "BROKER_ID INSTRUMENT_ID", \n    "DROP_COLUMNS": "FULLY_FILLED"\n  }\n}\n')),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "MORE_COLUMNS_ACK",\n    "SOURCE_REF": "123456-789032"\n}\n')),(0,s.kt)("h3",{id:"more_rows"},"MORE_ROWS"),(0,s.kt)("p",null,"PUT requests can also be used to request MORE_ROWS. This is when the client has specified a ",(0,s.kt)("inlineCode",{parentName:"p"},"MAX_ROWS")," and received that many rows, but would like to get more. This is handy for pagination implementations."),(0,s.kt)("p",null,"This is requested via a PUT request to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/[data_server_query_name]"),"."),(0,s.kt)("p",null,"The body of this request should contain a ",(0,s.kt)("inlineCode",{parentName:"p"},"MESSAGE_TYPE")," element with the value MORE_ROWS."),(0,s.kt)("p",null,"The reply will be a simple ACK/NACK. Assuming an ACK, the next QUERY_UPDATE request will include the additional rows."),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'PUT /my-trades HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSOURCE_REF: 123456-789031\nSESSION_AUTH_TOKEN: 83eLYBnlqjIWt1tqtJhKwTXJj2IL2WA0\n\n{\n    "MESSAGE_TYPE": "MORE_ROWS"\n}\n')),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "MORE_ROWS_ACK",\n    "SOURCE_REF": "123456-789031"\n}\n')),(0,s.kt)("h3",{id:"data_logoff"},"DATA_LOGOFF"),(0,s.kt)("p",null,"A DELETE request is made to log off and end the subscription for the given ",(0,s.kt)("inlineCode",{parentName:"p"},"SOURCE_REF"),"."),(0,s.kt)("p",null,"This is requested via a DELETE request to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/[data_server_query_name]"),"."),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"SOURCE_REF")," should match that used in the original DATA_LOGON (subscription)."),(0,s.kt)("p",null,"No body is required for DATA_LOGOFF."),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},"DELETE /my-trades HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSOURCE_REF: 123456-789031\nSESSION_AUTH_TOKEN: 83eLYBnlqjIWt1tqtJhKwTXJj2IL2WA0\n")),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "DATA_LOGOFF",\n    "SOURCE_REF": "123456-789031"\n}\n')),(0,s.kt)("h2",{id:"request-server"},"Request Server"),(0,s.kt)("p",null,"Request Servers are accessed via GET requests to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/[request_reply_name]"),"."),(0,s.kt)("p",null,"Any request parameters should be prefixed with ",(0,s.kt)("inlineCode",{parentName:"p"},"request."),". E.g. ",(0,s.kt)("inlineCode",{parentName:"p"},"request.[request_parameter]=[value]"),". For example ",(0,s.kt)("inlineCode",{parentName:"p"},"localhost:9064/req-counterparty-details?request.[request_parameter]=[value]&request.[request_parameter]=[value]"),"."),(0,s.kt)("p",null,"Parameter values can be wild-carded (",(0,s.kt)("inlineCode",{parentName:"p"},"*"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"A*"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"_A"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"_A*"),", etc.) or left blank (and assumed to be ",(0,s.kt)("inlineCode",{parentName:"p"},"*"),")."),(0,s.kt)("p",null,"Request Server requests require:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SOURCE_REF")," header (a unique value should be supplied on every request with a unique value)"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SESSION_AUTH_TOKEN")," header"),(0,s.kt)("li",{parentName:"ul"},"A request body as per your event handler in side the ",(0,s.kt)("inlineCode",{parentName:"li"},"DETAILS")," object.")),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},"GET /req-counterparty-details?request.CPTY_TYPE=MARKET&request.CPTY_REGION=US HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSESSION_AUTH_TOKEN: 83eLYBnlqjIWt1tqtJhKwTXJj2IL2WA0\nSOURCE_REF: 123456-789021\n")),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "REP_COUNTERPARTY_DETAILS",\n    "SOURCE_REF": "123456-789021",\n    "REPLY": [\n        {\n            "CPTY_NAME": "ROAD_RUNNER_FUNDS"\n        },\n        {\n            "CPTY_NAME": "COYOTE_BROKERING"\n        }\n    ]\n}\n')),(0,s.kt)("h2",{id:"event-handler"},"Event Handler"),(0,s.kt)("p",null,"Events are submitted via POST requests to\n",(0,s.kt)("inlineCode",{parentName:"p"},"[host]:[genesis_router_port]/event_[<event_name>]"),"."),(0,s.kt)("p",null,"All resource paths should be prefixed with ",(0,s.kt)("inlineCode",{parentName:"p"},"event_"),". For example ",(0,s.kt)("inlineCode",{parentName:"p"},"localhost:9064/event_order_insert"),". In this example ",(0,s.kt)("inlineCode",{parentName:"p"},"order_insert")," is our custom event route and ",(0,s.kt)("inlineCode",{parentName:"p"},"event_")," is the prefix."),(0,s.kt)("p",null,"Event Handler requests require:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SOURCE_REF")," header (a unique value should be supplied on every request with a unique value)"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SESSION_AUTH_TOKEN")," header"),(0,s.kt)("li",{parentName:"ul"},"A request body as per your event handler in side the ",(0,s.kt)("inlineCode",{parentName:"li"},"DETAILS")," object.")),(0,s.kt)("p",null,"Sample request:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'POST /event-order-insert HTTP/1.1\nHost: localhost:9064\nContent-Type: application/json\nSESSION_AUTH_TOKEN: 83eLYBnlqjIWt1tqtJhKwTXJj2IL2WA0\nSOURCE_REF: 123456-789011\n\n{ \n    "DETAILS": { \n        "INSTRUMENT_CODE":"VOD",\n        "QUANTITY":"100",\n        "PRICE":"225"\n    }\n}\n')),(0,s.kt)("p",null,"Sample response:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "MESSAGE_TYPE": "EVENT_ACK",\n    "SOURCE_REF": "123456-789011"\n}\n')))}T.isMDXComponent=!0}}]);