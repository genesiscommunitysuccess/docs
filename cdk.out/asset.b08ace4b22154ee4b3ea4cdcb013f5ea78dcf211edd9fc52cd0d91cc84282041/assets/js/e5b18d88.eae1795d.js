"use strict";(self.webpackChunk_genesislcap_docs=self.webpackChunk_genesislcap_docs||[]).push([[43080],{65237:function(e,t,i){i.r(t),i.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return c}});var n=i(87462),s=i(63366),a=(i(67294),i(3905)),r=(i(61839),["components"]),o={title:"Access Control - Authorisation Overview",sidebar_label:"Authorisation Overview",id:"authorisation-overview",keywords:["server","access control","authorisation","overview"],tags:["server","access control","authorisation","overview"]},l=void 0,p={unversionedId:"server/access-control/authorisation-overview",id:"server/access-control/authorisation-overview",title:"Access Control - Authorisation Overview",description:"Introduction  | Authentication overview | Username and Password | SSO | Authorisation overview | Authorisation",source:"@site/docs/03_server/05_access-control/05_authorisation-overview.md",sourceDirName:"03_server/05_access-control",slug:"/server/access-control/authorisation-overview",permalink:"/next/server/access-control/authorisation-overview",draft:!1,tags:[{label:"server",permalink:"/next/tags/server"},{label:"access control",permalink:"/next/tags/access-control"},{label:"authorisation",permalink:"/next/tags/authorisation"},{label:"overview",permalink:"/next/tags/overview"}],version:"current",sidebarPosition:5,frontMatter:{title:"Access Control - Authorisation Overview",sidebar_label:"Authorisation Overview",id:"authorisation-overview",keywords:["server","access control","authorisation","overview"],tags:["server","access control","authorisation","overview"]},sidebar:"serverModulesSidebar",previous:{title:"SSO Authentication",permalink:"/next/server/access-control/SSO-authentication"},next:{title:"Authorisation",permalink:"/next/server/access-control/authorisation"}},u={},c=[{value:"Authorisation",id:"authorisation",level:2},{value:"Global and specific permissioning",id:"global-and-specific-permissioning",level:3},{value:"Permissioning sub-blocks",id:"permissioning-sub-blocks",level:3},{value:"PermissionCodes list",id:"permissioncodes-list",level:4},{value:"Auth sub-block",id:"auth-sub-block",level:4},{value:"Generic permissions",id:"generic-permissions",level:2}],m={toc:c};function h(e){var t=e.components,i=(0,s.Z)(e,r);return(0,a.kt)("wrapper",(0,n.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/server/access-control/introduction"},"Introduction"),"  | ",(0,a.kt)("a",{parentName:"p",href:"/server/access-control/authentication-overview"},"Authentication overview")," | ",(0,a.kt)("a",{parentName:"p",href:"/server/access-control/password-authentication"},"Username and Password")," | ",(0,a.kt)("a",{parentName:"p",href:"/server/access-control/sso-authentication"},"SSO")," | ",(0,a.kt)("a",{parentName:"p",href:"/server/access-control/authorisation-overview"},"Authorisation overview")," | ",(0,a.kt)("a",{parentName:"p",href:"/server/access-control/authorisation"},"Authorisation")),(0,a.kt)("h2",{id:"authorisation"},"Authorisation"),(0,a.kt)("p",null,"Authorisation is the process by which you apply specific permissions to resources. Only users who pass the permission criteria for the resource have access."),(0,a.kt)("p",null,"The server of a Genesis application provides three main types of resource entry point for clients to instigate events or to query data."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Data Servers"),(0,a.kt)("li",{parentName:"ul"},"Event Handlers"),(0,a.kt)("li",{parentName:"ul"},"Request Servers")),(0,a.kt)("p",null,"All these services can be permissioned using a permissioning GPAL syntax block in the GPAL configuration associated with the service."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Permissioning block snippet")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'// this example would be enclosed within a resource (eg DataServer Query) specific block\npermissioning {\n    \n    // \'permission Code\' list, users must have the permission to access the enclosing resource\n    permissionCodes = listOf("TRADER", "SUPPORT")\n    \n    // Permission at the row and/or column level for a grid or table of data\n    auth("TRADE_VISIBILITY") {\n        TRADE_VIEW.TRADE_ID\n    }\n}\n')),(0,a.kt)("h3",{id:"global-and-specific-permissioning"},"Global and specific permissioning"),(0,a.kt)("p",null,"Here's what you need to know:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A permissioning block can exist inside a resource (",(0,a.kt)("inlineCode",{parentName:"li"},"requestReply"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"query")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"eventHandler"),") definition. In this case, it applies only to that resource definition. This is specific permissioning."),(0,a.kt)("li",{parentName:"ul"},"Alternatively, you can specify a permissioning block outside any resource in the file. This is global permissioning. If you do this, the permissioning applies by default to all the resources in the file. ",(0,a.kt)("strong",{parentName:"li"},"However, any permissioning block inside a specific resource overrides this default"),"."),(0,a.kt)("li",{parentName:"ul"},"The permissioning block at the global level can only contain ",(0,a.kt)("inlineCode",{parentName:"li"},"permissionCodes"),", as the ",(0,a.kt)("inlineCode",{parentName:"li"},"auth")," block is based on each individual resource definition."),(0,a.kt)("li",{parentName:"ul"},"Every request that comes into a Genesis server will include the username of an authenticated user. Non-authenticated users will not have access to or visibility of the Genesis services.")),(0,a.kt)("p",null,"In the example below, the block applies to a specific ",(0,a.kt)("inlineCode",{parentName:"p"},"requestReply")," within a Request Server:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'requestReplies {\n    requestReply("MARKET_INSTRUMENTS", INSTRUMENT_DETAILS) {\n        permissioning {\n            permissionCodes = listOf("TRADER")\n        }\n    }\n}\n')),(0,a.kt)("p",null,"In the example below, the global permissioning applies by default to the first three ",(0,a.kt)("inlineCode",{parentName:"p"},"requestReply")," blocks in the Request Server. However, the fourth ",(0,a.kt)("inlineCode",{parentName:"p"},"requestReply")," block has a specific permissioning block requiring the user to be in the list SUPER."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'requestReplies {\n    permissioning {\n        permissionCodes = listOf("TRADER")\n    }\n    requestReply("ALLOCATION CODES", ALLOCATION CODES)\n\n    requestReply("ALL_COUNTERPARTIES", ALL_COUNTERPARTIES)\n\n    requestReply("ALL_BROKERS", ALL_BROKERS)\n\n    requestReply("ALL_TRADES", INSTRUMENT_DETAILS) {\n        permissioning {\n            permissionCodes = listOf("SUPER")\n        }\n    }\n}\n')),(0,a.kt)("h3",{id:"permissioning-sub-blocks"},"Permissioning sub-blocks"),(0,a.kt)("p",null,"There are two main sub-blocks to the permissioning block that can be applied to suit your needs:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"PermissionCodes")," list"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"auth")," sub-block")),(0,a.kt)("h4",{id:"permissioncodes-list"},"PermissionCodes list"),(0,a.kt)("p",null,"Here is a simple example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'permissionCodes = listOf("TRADER", "SUPPORT")\n')),(0,a.kt)("p",null,"Where a ",(0,a.kt)("inlineCode",{parentName:"p"},"PermissionCodes"),"list is defined, the user must have one of the listed permission codes to access the GPAL enclosed resource.\nIf the user does not belong to one of the listed permission codes, the subsequent auth block will essentially be ignored."),(0,a.kt)("p",null,"To enable a user to have access to a specific ",(0,a.kt)("inlineCode",{parentName:"p"},"permissionCode"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"the ",(0,a.kt)("inlineCode",{parentName:"li"},"permissionCode")," must be defined in the ",(0,a.kt)("inlineCode",{parentName:"li"},"RIGHT")," table"),(0,a.kt)("li",{parentName:"ul"},"the code must be linked to an entry in the ",(0,a.kt)("inlineCode",{parentName:"li"},"PROFILE_RIGHT")," table"),(0,a.kt)("li",{parentName:"ul"},"the code must be linked to a ",(0,a.kt)("inlineCode",{parentName:"li"},"PROFILE")," that is associated with the USER from ",(0,a.kt)("inlineCode",{parentName:"li"},"PROFILE_USER"))),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"AUTH_MANAGER")," process will populate the ",(0,a.kt)("inlineCode",{parentName:"p"},"RIGHT_SUMMARY")," table based on the table configurations above. This table ultimately drives the available permission codes for all users in the system."),(0,a.kt)("p",null,"These tables are part of the Genesis Auth module."),(0,a.kt)("h4",{id:"auth-sub-block"},"Auth sub-block"),(0,a.kt)("p",null,"Here is an example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'        auth(mapName = "ENTITY_VISIBILITY") {\n            POSITION.COUNTERPARTY_ID\n        }\n')),(0,a.kt)("p",null,"Where an ",(0,a.kt)("inlineCode",{parentName:"p"},"auth")," sub-block is defined, you can provide further fine-grained control of what data, at the row level, is returned to a specific user. If it is not defined, then all data is returned for the enclosing resource, assuming ",(0,a.kt)("inlineCode",{parentName:"p"},"permissionCodes")," are not restricting access."),(0,a.kt)("p",null,"The reference ",(0,a.kt)("inlineCode",{parentName:"p"},"POSITION.COUNTERPARTY_ID"),' in the auth snippet above refers to the COUNTERPARTY_ID field from the POSITION object that is supplied as a parameter to the resource request. This value is used as a key into a specific AuthCache, identified by entity name. In this example, that is "ENTITY_VISIBILITY"'),(0,a.kt)("p",null,"Each AuthCache will map Entity Id (in our example, COUNTERPARTY_ID from the POSITION object) to a Set of users."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"mapName")," parameter refers to a specific permission entity defined on the server via the ",(0,a.kt)("a",{parentName:"p",href:"/server/access-control/authorisation/#defining-a-permission-rule"},"auth-permission.xml")," file. For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},' <dynamicPermissions>\n  \x3c!-- other tags removed for brevity --\x3e\n   <entity name="ENTITY_VISIBILITY"\n              tableName="USER_COUNTERPARTY_MAP"\n              maxEntries="20000"\n              idField="USER_NAME">\n    \x3c!-- further structure with groovy expression to define programmatic control and define an AuthMap --\x3e\n    </entity>\n  \x3c!-- additional entities would go here--\x3e\n</dynamicPermissions>\n')),(0,a.kt)("h2",{id:"generic-permissions"},"Generic permissions"),(0,a.kt)("p",null,"Generic permissions is a term used to name the optional permissions configuration that is available for a Genesis application; this is included as part of the Genesis Auth Module."),(0,a.kt)("p",null,"To fully activate Generic permissions, you need to add the following values to your ",(0,a.kt)("a",{parentName:"p",href:"/server/configuring-runtime/system-definitions/"},"system definition file")," before you run ",(0,a.kt)("inlineCode",{parentName:"p"},"genesisInstall"),".\nThese values specify which table column will be used to associate users to entities for fine-grained row permissions."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'systemDefinition {\n    global {\n        item(name = "ADMIN_PERMISSION_ENTITY_TABLE", value = "COUNTERPARTY")\n        item(name = "ADMIN_PERMISSION_ENTITY_FIELD", value = "COUNTERPARTY_ID")\n    }\n}\n')),(0,a.kt)("p",null,"Note these ",(0,a.kt)("strong",{parentName:"p"},"important")," details:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"These values will add the specified field to the ",(0,a.kt)("inlineCode",{parentName:"p"},"USER_ATTRIBUTES")," table as a required field and create a new table called ",(0,a.kt)("inlineCode",{parentName:"p"},"USER_COUNTERPARTY_MAP")," (in the case of our example), which will be suitably populated by the AUTH_MANAGER process on a real-time basis.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The ",(0,a.kt)("inlineCode",{parentName:"p"},"USER_COUNTERPARTY_MAP")," table is referenced in the ",(0,a.kt)("inlineCode",{parentName:"p"},"ENTITY_VISIBILITY")," entity in the ",(0,a.kt)("strong",{parentName:"p"},"auth-permission.templt.xml")," file. This file is a Genesis ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Mustache_(template_system)"},"mustache"),"\ntemplate that is processed when ",(0,a.kt)("inlineCode",{parentName:"p"},"genesisInstall")," is run, using entries from system-definition.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"When new users are created in the Genesis GUI Admin screens, a required field, COUNTERPARTY, is presented to the operating user. This limits users to belonging to a single counterparty."))),(0,a.kt)("p",null,"A user can define additional ",(0,a.kt)("strong",{parentName:"p"},"permissions.xml")," files. For example, you could define something like ",(0,a.kt)("strong",{parentName:"p"},"order-management-permissions.xml"),", with an order management system auth implementation, and it will be read by ",(0,a.kt)("inlineCode",{parentName:"p"},"AUTH_PERMS")," process on startup."),(0,a.kt)("p",null,"There are two kinds of permission entity defined by Generic Permissions in the ",(0,a.kt)("strong",{parentName:"p"},"auth-permission.templt.xml")," file:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"USER_VISIBILITY")," - an AuthCache that determines which user is visible to which user; this is driven by which users are associated for the entity. Using our example, if two users are both in the same counterparty, then they should be viewable to each other.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"ENTITY_VISIBILITY")," - an AuthCache that determines if a user has access to particular entity; in our example, if the user is permissioned for a particular counterparty, then it will be able to see the associated row data for that counterparty."))))}h.isMDXComponent=!0}}]);