---
title: 'Rule expression builder'
sidebar_label: 'Rule expression builder'
id: client-expression-rule-builder
keywords: [ builder ]
tags:
- builder
sidebar_position: 15
---

import { CollapsibleSlot } from '../../../../examples/ui/documentationBase'
import { RuleBuilderExample } from './expression_builder_examples.js'

# Rule expression builder

The rule expression builder is a UI component which allows the user to configure boolean expressions upon a set of data. The generated expression can then be directly executed by the evaluator and criteria back-end services.

Use cases:
* Allow the user to define a set of filters which can be used on a dataset.
* Configure predicate expressions to execute actions when specific conditions are realised.
* Allow run-time configuration of rules which dictate application function, which typically would require developer code changes.

:::tip
This component is based on the [expression builder library](..) and is pre-configured to create boolean expressions that the back-end can work with. If you want to set your own operations and other configurations you can create your own component using the base library.
:::

## Example

You can add, change, or delete a rule to create different expressions based upon input fields. You can use groups to join rules using specific boolean combinators (`AND` and `OR`) to create complex expressions. When you change the expression model on the UI you can see the json payload which is created change on the right hand side (click the button to show the model if it's currently hidden).

Notice that if a rule is highlighted in red when it's partially defined (e.g. you've chosen the field but not an operator), then the model payload on the right hand side won't change. This is because the back-end model doesn't support partial rules. It is possible to look at the underlying model which contains a tree structure even for partial rules.

<RuleBuilderExample />

<Tabs defaultValue="genesis" values={[{ label: 'Genesis', value: 'genesis', }, { label: 'React', value: 'react', }, { label: 'Angular', value: 'angular', }]}>

  <TabItem value="genesis">

Declaration
```html
<rapid-rule-expression-builder></rapid-rule-expression-builder>
```

    Usage
    ```typescript
import { ExpressionBuilderTypes, RuleExpression } from '@genesislcap/rapid-design-system';
// See further down for code snippet containing fields
import { fields } from './fields';
@customElement({
  name: 'my-element',
  template: html<MyElement>`
    <rapid-rule-expression-builder
      :ruleConfig=${(x) => x.ruleConfig}
      @change=${(x) =>
        x.handleChangedRuleExpression(
          x.event as CustomEvent<RuleExpression.Expression['PredicateExpression']>,
        )}
    ></rapid-rule-expression-builder>
  `,
})
export class MyElement extends GenesisElement {
  ruleConfig: ExpressionBuilderTypes.RuleConfig = {
    fields, // from import
    // you can also set the model and other configuration options here
  }
  handleChangedRuleExpression(e: CustomEvent<RuleExpression.Expression['PredicateExpression']>){
    const newModel = e.detail;
    console.log({newModel});
  }
}
    ```

  </TabItem>
  <TabItem value="react">

Declaration
```html
<rapid-rule-expression-builder></rapid-rule-expression-builder>
```

    Usage
    ```tsx
    export function MyComponent() {
      const dialogRef = useRef(null);

      return (
        <CodeSection>
          <rapid-rule-expression-builder onClick={() => console.log('previous')} direction="previous"></rapid-rule-expression-builder>
          <rapid-rule-expression-builder onClick={() => console.log('next')} direction="next"></rapid-rule-expression-builder>
        </CodeSection >
      )
    }
    ```
  </TabItem>
  <TabItem value="angular">

    Declaration
    ```html
    <rapid-rule-expression-builder></rapid-rule-expression-builder>
    ```

    Usage
    ```typescript
    import { Component, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';

    @Component({
      selector: 'my-component',
      template: `
        <code-section>
          <rapid-rule-expression-builder
            direction="previous"
            (click)="onPreviousClick()"
          ></rapid-rule-expression-builder>
          <rapid-rule-expression-builder
            direction="next"
            (click)="onNextClick()"
          ></rapid-rule-expression-builder>
        </code-section>
      `,
      standalone: true,
      schemas: [CUSTOM_ELEMENTS_SCHEMA],
    })
    export class MyComponent {
      onPreviousClick() {
        console.log('previous');
      }

      onNextClick() {
        console.log('next');
      }
    }
    ```
  </TabItem>
</Tabs>


<CollapsibleSlot title="fields.ts" description="Expand to see example fields you can use with the rule expression builder for testing and learning">
```typescript
import { ExpressionBuilderTypes } from '@genesislcap/rapid-design-system';

const EXAMPLE_MIN_AGE = 18;

export const fields = [
  {
    fieldId: 'firstName',
    label: 'First Name',
    type: 'string',
    input: 'text',
    defaultValue: 'John',
  },
  {
    fieldId: 'lastName',
    label: 'Last Name',
    type: 'string',
    input: 'text',
  },
  {
    fieldId: 'age',
    label: 'Age',
    type: 'int',
    input: 'number',
    validation: (age) =>
      parseInt(age) < EXAMPLE_MIN_AGE ? `User must be at least ${EXAMPLE_MIN_AGE}` : null,
  },
  {
    fieldId: 'weight',
    label: 'Weight',
    type: 'double',
    input: 'number',
  },
  {
    fieldId: 'isActive',
    label: 'Is Active',
    type: 'boolean',
    input: 'checkbox',
  },
  {
    fieldId: 'dateJoined',
    label: 'Date Joined',
    type: 'date',
    input: 'date',
  },
  {
    fieldId: 'country',
    label: 'Country',
    type: 'enum',
    input: 'select',
    values: {
      usa: 'United States',
      canada: 'Canada',
      uk: 'United Kingdom',
    },
  },
  {
    fieldId: 'lastUpdated',
    label: 'Last Updated',
    type: 'date-time',
    input: 'datetime-local',
  },
];
```
</CollapsibleSlot>

## DOM API

Property and attribute binding examples for Genesis Component syntax. Closing tag omitted.

### Attributes

This component doesn't have any attributes.

### Properties

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Type</th>
      <th>Use</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ruleConfig</td>
      <td>LINK</td>
      <td>The primary configuration point for the component which allows you to specify input fields, optionally set the model, among other configuration items.</td>
      <td>

```typescript
<rapid-rule-expression-builder :ruleConfig="${(x) => x.ruleConfig}">
```

      </td>
    </tr>
    <tr>
      <td>styles</td>
      <td>LINK</td>
      <td>Allows you to change which custom elements and their styles are used inside of the component. This isn't recommended to be used, if you want to use a custom style for an element, such as the checkbox, you should override its style when registering the component.</td>
<td>

```typescript
<rapid-rule-expression-builder :styles="${(x) => x.styles}">
```

</td>
    </tr>
    <tr>
      <td>model</td>
      <td>LINK</td>
      <td>This is a <em>readonly</em> property and therefore shouldn't be set directly - if you want to set the model then do it via the optional model property on the <code>ruleConfig</code> block. This property can be used to receive the precise underlying model the UI state currently represents. This can be useful when the user has configured a partial rule (e.g. only selected a field in a rule) which isn't valid server rule and therefore will not be shown on the change event payload.</td>
<td>

```typesscript
const model = document.querySelector('rapid-rule-expression-builder').model;
```

</td>
    </tr>
  </tbody>
</table>
